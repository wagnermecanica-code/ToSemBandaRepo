REFACTOR_MESSAGES_NOW.md
# REFACTOR: MIGRAÇÃO COMPLETA DA FEATURE MESSAGES - EXECUTAR AGORA

Você é um arquiteto Flutter sênior. Execute imediatamente a migração completa da feature MESSAGES/CHAT seguindo 100% as instruções abaixo.

Você já migrou com sucesso AUTH, PROFILE e POST.
Agora é a vez da feature MESSAGES (lista de conversas + chat detalhe + swipe actions + suporte a emojis + paginação).

TAREFA ATUAL — MIGRAÇÃO COMPLETA DA FEATURE MESSAGES:

Crie a estrutura completa:
features/messages/
├── data/
│   ├── datasources/
│   │   └── messages_remote_datasource.dart
│   └── repositories/
│       └── messages_repository_impl.dart
├── domain/
│   ├── entities/
│   │   ├── conversation_entity.dart (freezed)
│   │   └── message_entity.dart (freezed)
│   ├── repositories/
│   │   └── messages_repository.dart (interface)
│   └── usecases/
│       ├── load_conversations.dart
│       ├── load_messages.dart
│       ├── send_message.dart
│       ├── send_image.dart
│       ├── mark_as_read.dart
│       ├── delete_conversation.dart
│       └── mark_as_unread.dart
└── presentation/
    ├── pages/
    │   ├── messages_page.dart
    │   └── chat_detail_page.dart
    ├── providers/
    │   └── messages_providers.dart
    └── widgets/
        ├── conversation_item.dart
        ├── message_bubble.dart
        └── swipe_actions_background.dart

Regras obrigatórias:
- Mova fisicamente messages_page.dart e chat_detail_page.dart para features/messages/presentation/pages/
- Mantenha 100% do comportamento atual:
  → Swipe left = deletar com confirmação (vermelho)
  → Swipe right = marcar como não lida (laranja)
  → Suporte completo a emojis (sanitizeText preserva tudo)
  → Paginação com 20 mensagens/conversas por página
  → MessageBubble com reply, reações futuras, timestamp
  → Badge de não lidas no BottomNav continua funcionando em tempo real
- Use freezed em ConversationEntity e MessageEntity com todos os campos atuais
- Crie MessagesResult sealed class
- Providers relacionados ficam em features/messages/presentation/providers/
- Provider global de badge (unreadMessageCountForProfileProvider) continua em core/di/ mas agora injeta o novo MessagesRepository
- 100% retrocompatibilidade — Notifications, BottomNav, ProfileSwitcher continuam funcionando perfeitamente
- Atualize todos os imports automaticamente

Quando terminar e o app rodar perfeitamente (testado swipe actions, envio de mensagem com foto, emojis, paginação e badge counters), responda exatamente com:

"Messages migration complete — agora só falta Notifications e seu app vira referência nacional de arquitetura Flutter"

Comece agora.